<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>üì¶ X-Cargo Express ‚Äî Track Package</title>
<style>
  body{font-family:Inter,"Segoe UI",sans-serif;background:#f6f8fb;margin:0;padding:20px;color:#222}
  h1{text-align:center;color:#007bff;margin-bottom:20px}
  form{max-width:500px;margin:0 auto 20px;display:flex;gap:8px}
  input{flex:1;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:16px}
  button{background:#007bff;color:#fff;border:none;padding:10px 16px;border-radius:8px;font-weight:700;cursor:pointer}
  .result{max-width:800px;margin:0 auto;background:#fff;padding:16px;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,.06);display:none}
  .inv-header{display:flex;align-items:center;gap:16px;border-bottom:2px solid #eee;padding-bottom:10px;margin-bottom:10px}
  .inv-logo{width:90px;height:90px;object-fit:contain;border-radius:8px;background:#fff;border:1px solid #eee}
  .inv-meta{margin-left:auto;text-align:right;font-size:13px;color:#555}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  th,td{border:1px solid #eee;padding:8px;font-size:14px;text-align:left}
  .status-badge{display:inline-block;padding:6px 12px;border-radius:18px;color:#fff;font-weight:700;margin-top:6px}
  .warning{margin-top:10px;font-weight:700;padding:8px 10px;border-radius:8px;display:inline-block}
  .images{margin-top:12px;display:flex;flex-wrap:wrap;gap:8px}
  .images img{width:180px;height:120px;object-fit:cover;border-radius:8px;border:1px solid #eee}
  .not-found{text-align:center;color:#f00;font-weight:600;margin-top:20px}
</style>
</head>
<body>

<h1>üì¶ Track Your Package</h1>

<form id="trackForm">
  <input type="text" id="trackingIdInput" placeholder="Enter your Tracking ID (e.g. XCE123456)" required>
  <button type="submit">Track</button>
</form>

<div id="result" class="result">
  <div class="inv-header">
    <img id="invLogo" class="inv-logo" src="" alt="Company Logo">
    <div>
      <h2 style="margin:0;color:#007bff">üì¶ X-Cargo Express</h2>
      <div style="color:#555;font-size:13px">123 Express Avenue, Florida, USA<br>support@xcargoexpress.com | +1-800-555-XCEX</div>
    </div>
    <div class="inv-meta" id="invMeta"></div>
  </div>

  <div id="statusWrap"></div>

  <table>
    <tbody>
      <tr><th>Tracking ID</th><td id="iTracking"></td></tr>
      <tr><th>Sender</th><td id="iSender"></td></tr>
      <tr><th>Receiver</th><td id="iReceiver"></td></tr>
      <tr><th>Address</th><td id="iAddress"></td></tr>
      <tr><th>Shipment Date</th><td id="iShip"></td></tr>
      <tr><th>Expected Delivery</th><td id="iExpected"></td></tr>
      <tr><th>Weight</th><td id="iWeight"></td></tr>
      <tr><th>Quantity</th><td id="iQuantity"></td></tr>
      <tr><th>Description</th><td id="iDesc"></td></tr>
    </tbody>
  </table>

  <div id="iWarning"></div>
  <div id="iImages" class="images"></div>
</div>

<p id="notFound" class="not-found" style="display:none">‚ùå Tracking ID not found. Please check and try again.</p>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
  import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBLYDpP68NlfYGE1O9DafgrmFBUlgpoYeI",
    authDomain: "x-cargo-exprees.firebaseapp.com",
    databaseURL: "https://x-cargo-exprees-default-rtdb.firebaseio.com",
    projectId: "x-cargo-exprees",
    storageBucket: "x-cargo-exprees.appspot.com",
    messagingSenderId: "1082201867958",
    appId: "1:1082201867958:web:d6600fbc82085b0b62c817"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const trackForm = document.getElementById("trackForm");
  const result = document.getElementById("result");
  const notFound = document.getElementById("notFound");

  trackForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const trackingId = document.getElementById("trackingIdInput").value.trim();
    if (!trackingId) return alert("Please enter a valid Tracking ID.");

    const dbRef = ref(db);
    const snap = await get(child(dbRef, "packages/" + trackingId));

    if (snap.exists()) {
      const data = snap.val();
      notFound.style.display = "none";
      result.style.display = "block";

      // fill invoice
      document.getElementById("invLogo").src = data.logoURL || "";
      document.getElementById("iTracking").textContent = data.trackingId;
      document.getElementById("iSender").textContent = data.sender;
      document.getElementById("iReceiver").textContent = data.receiver;
      document.getElementById("iAddress").textContent = data.address;
      document.getElementById("iShip").textContent = data.shipmentDate || "-";
      document.getElementById("iExpected").textContent = data.expectedDate || "-";
      document.getElementById("iWeight").textContent = data.weight || "-";
      document.getElementById("iQuantity").textContent = data.quantity || "-";
      document.getElementById("iDesc").textContent = data.description || "-";

      document.getElementById("statusWrap").innerHTML =
        `<div class="status-badge" style="background:${data.statusColor || '#007bff'}">${data.status}</div>`;

      // Warning message
      const warningDiv = document.getElementById("iWarning");
      if (data.showWarning && data.warningText) {
        warningDiv.innerHTML = `<div class="warning" style="color:${data.warningColor || '#ff0000'}">${data.warningText}</div>`;
      } else {
        warningDiv.innerHTML = "";
      }

      // images
      const imgWrap = document.getElementById("iImages");
      imgWrap.innerHTML = "";
      if (data.imageURLs && data.imageURLs.length) {
        data.imageURLs.forEach(u => imgWrap.innerHTML += `<img src="${u}" alt="Package image">`);
      }

    } else {
      result.style.display = "none";
      notFound.style.display = "block";
    }
  });
</script>
</body>
</html>
