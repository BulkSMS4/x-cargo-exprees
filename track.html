<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üöö X-Cargo Express - Track Package üõçÔ∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {font-family:"Segoe UI",sans-serif;background:#f5f7fb;color:#333;padding:25px;}
h2{text-align:center;margin-bottom:25px;color:#007bff;}
form{max-width:500px;margin:auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
label{display:block;margin-top:10px;font-weight:500;}
input{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;margin-top:5px;font-size:15px;}
button{background:#007bff;color:#fff;border:none;padding:12px;border-radius:6px;width:100%;margin-top:20px;font-size:16px;cursor:pointer;transition:0.3s;}
button:hover{background:#0056b3;}
.receipt{display:none;background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);max-width:700px;margin:30px auto;position:relative;}
.header{text-align:center;border-bottom:2px solid #007bff;padding-bottom:10px;margin-bottom:15px;}
.header img{width:80px;height:auto;display:block;margin:0 auto 8px;}
.header h2{margin:5px 0;}
.header p{margin:0;font-size:13px;color:#666;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
table td,table th{padding:8px;border:1px solid #ccc;font-size:14px;}
table th{background:#f1f1f1;text-align:left;}
.status-box{text-align:center;margin-top:10px;}
.status-badge{display:inline-block;padding:6px 14px;border-radius:20px;color:#fff;font-weight:bold;}
.warning-box{text-align:center;font-weight:bold;margin-top:10px;}
.pay-button{display:block;text-align:center;padding:10px 15px;border-radius:6px;margin:10px auto;color:#fff;text-decoration:none;}
.images{text-align:center;margin-top:15px;}
.images img{max-width:220px;margin:8px;border-radius:6px;}
#stampsContainer{position:relative; min-height:50px;}
#selectedSignature{text-align:center;margin-top:10px;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>

<h2>üöö Track Your Package üõçÔ∏è</h2>

<form id="trackForm">
<label>Enter Tracking ID</label>
<input type="text" id="trackingId" placeholder="e.g. XCE123456" required>
<button type="button" id="fetchBtn">üîç Track Package</button>
</form>

<div id="receipt" class="receipt">
<div class="header">
<img id="headerLogo" src="" alt="Company Logo">
<h2>X-Cargo Express</h2>
<p>123 Express Avenue, Florida, USA</p>
<p>Email: support@xcargoexpress.com | Tel: +1-800-555-XCEX</p>
</div>

<div class="status-box" id="statusBox"></div>

<table>
<tr><th>Tracking ID</th><td id="rTracking"></td></tr>
<tr><th>Sender</th><td id="rSender"></td></tr>
<tr><th>Receiver</th><td id="rReceiver"></td></tr>
<tr><th>Address</th><td id="rAddress"></td></tr>
<tr><th>Shipment Date</th><td id="rShip"></td></tr>
<tr><th>Expected Delivery</th><td id="rExpected"></td></tr>
<tr><th>Weight</th><td id="rWeight"></td></tr>
<tr><th>Quantity</th><td id="rQuantity"></td></tr>
<tr><th>Description</th><td id="rDesc"></td></tr>
</table>

<div id="warningBox"></div>
<div id="payBox"></div>
<div class="images" id="imageSection"></div>
<div id="stampsContainer"></div>
<div id="selectedSignature"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

const firebaseConfig = {
apiKey: "AIzaSyBLYDpP68NlfYGE1O9DafgrmFBUlgpoYeI",
authDomain: "x-cargo-exprees.firebaseapp.com",
databaseURL: "https://x-cargo-exprees-default-rtdb.firebaseio.com",
projectId: "x-cargo-exprees",
storageBucket: "x-cargo-exprees.appspot.com",
messagingSenderId: "1082201867958",
appId: "1:1082201867958:web:d6600fbc82085b0b62c817"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

document.getElementById("fetchBtn").addEventListener("click", async ()=>{
  const trackingId = document.getElementById("trackingId").value.trim();
  if(!trackingId){alert("Enter Tracking ID"); return;}
  const dbRef = ref(db);
  const snapshot = await get(child(dbRef,"packages/"+trackingId));
  if(!snapshot.exists()){alert("‚ùå Package not found"); return;}
  const data = snapshot.val();
  document.getElementById("receipt").style.display="block";

  document.getElementById("rTracking").textContent=data.trackingId||"";
  document.getElementById("rSender").textContent=data.sender||"";
  document.getElementById("rReceiver").textContent=data.receiver||"";
  document.getElementById("rAddress").textContent=data.address||"";
  document.getElementById("rShip").textContent=data.shipmentDate||"";
  document.getElementById("rExpected").textContent=data.expectedDate||"";
  document.getElementById("rWeight").textContent=data.weight||"";
  document.getElementById("rQuantity").textContent=data.quantity||"";
  document.getElementById("rDesc").textContent=data.description||"";
  document.getElementById("headerLogo").src=data.logoURL||"";

  // Status
  document.getElementById("statusBox").innerHTML=`<span class="status-badge" style="background:${data.statusColor||'#007bff'}">${data.status||'Pending'}</span>`;

  // Warning
  document.getElementById("warningBox").innerHTML=(data.showWarning?`<div class="warning-box" style="color:${data.warningColor||'#ff0000'}">${data.warningText||''}</div>`:'');
  
  // Payment Button
  if(data.showPay && data.payURL){
    const payBtn = document.createElement("a");
    payBtn.href=data.payURL;
    payBtn.textContent=data.payText||"Pay Now";
    payBtn.className="pay-button";
    payBtn.style.backgroundColor=data.payColor||"#28a745";
    document.getElementById("payBox").innerHTML="";
    document.getElementById("payBox").appendChild(payBtn);
  }else{
    document.getElementById("payBox").innerHTML="";
  }

  // Package images
  const imageSection=document.getElementById("imageSection"); imageSection.innerHTML="";
  if(data.packageImages){Object.values(data.packageImages).forEach(url=>{ imageSection.innerHTML+=`<img src="${url}" alt="Package Image">`;}); }

  // Stamps
  const stampsContainer=document.getElementById("stampsContainer");
  stampsContainer.innerHTML="";
  if(data.stamps){data.stamps.forEach(url=>{ const img=document.createElement("img"); img.src=url; img.className="draggable-stamp"; img.style.position="relative"; img.style.width="100px"; stampsContainer.appendChild(img);}); }

  // Signature
  const sigContainer=document.getElementById("selectedSignature");
  sigContainer.innerHTML="";
  if(data.signatureURL){const sigImg=document.createElement("img"); sigImg.src=data.signatureURL; sigImg.style.maxWidth="300px"; sigContainer.appendChild(sigImg);}
});
</script>
</body>
</html>
